@using RPK_BlazorApp.Models.UI
@using Microsoft.AspNetCore.Components
@using Microsoft.FluentUI.AspNetCore.Components

@typeparam TItem where TItem : class

<div class="generic-sort-container">
    @foreach (var sortCriterion in _sortCriteria)
    {
        <div class="sort-row">
            <FluentSelect Label="Sort Column" @bind-Value="sortCriterion.FieldName" TOption="string">
                @foreach (var column in ColumnDefinitions.Where(c => c.IsSortable))
                {
                    <FluentOption Value="@column.FieldName" TOption="string">@column.DisplayName</FluentOption>
                }
            </FluentSelect>

            <FluentSelect Label="Sort Direction" @bind-Value="sortCriterion.SortDirection" TOption="string">
                <FluentOption Value="asc" TOption="string">Ascending</FluentOption>
                <FluentOption Value="desc" TOption="string">Descending</FluentOption>
            </FluentSelect>

            @if (_sortCriteria.Count > 1) // Only show remove button if more than one row
            {
                <FluentButton Appearance="Appearance.Outline" @onclick="() => RemoveSortRow(sortCriterion)">Remove</FluentButton>
            }
        </div>
    }

    <div class="sort-actions">
        <FluentButton Appearance="Appearance.Neutral" @onclick="AddSortRow" Disabled="@(_sortCriteria.Count >= 3)">Add Sort</FluentButton>
        <FluentButton Appearance="Appearance.Accent" @onclick="ApplySort">Apply Sort</FluentButton>
        <FluentButton Appearance="Appearance.Neutral" @onclick="ClearSort">Clear Sort</FluentButton>
    </div>
</div>